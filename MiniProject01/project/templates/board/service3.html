<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>리스트</title>  
    <link  rel="stylesheet" href="/static/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.11/c3.min.css"/>
    <link href="/css/normalize-e465cb86.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/css/foundation.min-978d4ce8.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/css/tomorrow-d7cf0921.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/css/c3-eb4b9be8.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/css/style-99fb8989.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/css/samples/chart_donut-da39a3ee.css" media="screen" rel="stylesheet" type="text/css" />
    <!-- include libraries(jQuery, bootstrap) -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.3/c3.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src = "https://cdnjs.cloudflare.com/ajax/libs/d3/5.9.7/d3.min.js"></script>
    <script src = "https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.3/c3.min.js"></script>
</head>
<body>

<div class='container'>
<h3> 연간 검색어 집계 </h3>
<div id='chart'>
</div>
<hr />
    <div class="form-inline row justify-content-end" 
        style="margin-top:5px; margin-bottom: 5px;">
        <form action='/board/service3' method='get'>
            
            <select class ='form-control' name='gene'>
            {% for i in GN %}
                {% if i == request.GET.gene %}
                <option value='{{i}}' selected>{{i}}</option>
                {% else %}
                <option value='{{i}}'>{{i}}</option>
                {% endif %}
            {% endfor %}
            </select> &nbsp;
            
            시작범위
            <select class ='form-control' name='year'>
                {% if request.GET.year == '2019' %}
                <option value='2019'selected>2019</option>
                {% else %}
                <option value='2019'>2019</option>
                {% endif %}

                {% if request.GET.year == '2020' %}
                <option value='2020'selected>2020</option>
                {% else %}
                <option value='2020'>2020</option>
                {% endif %}
            </select> &nbsp;
            
            
            <select class ='form-control' name='month'>
            {% for i in MM %}
                {% if i == request.GET.month %}
                <option value='{{i}}' selected>{{i}}월</option>
                {% else %}
                <option value='{{i}}'>{{i}}월</option>
                {% endif %}
            {% endfor %}
            </select> &nbsp;
            
            <select class ='form-control' name='day'>
                {% for i in DD %}
                    {% if i|stringformat:"i" == request.GET.day %}
                    <option value='{{i}}' selected>{{i}}일</option>
                    {% else %}
                    <option value='{{i}}'>{{i}}일</option>
                    {% endif %}
                {% endfor %}
            </select> &nbsp;
            
            <select class ='form-control' name='time'>
                {% for i in SS %}
                    {% if i|stringformat:"i" == request.GET.time %}
                    <option value='{{i}}' selected>{{i}}시</option>
                    {% else %}
                    <option value='{{i}}'>{{i}}시</option>
                    {% endif %}
                {% endfor %}
            </select> &nbsp;
            
            <select class ='form-control' name='rank'>
                {% for i in RK %}
                    {% if i|stringformat:"i" == request.GET.rank %}
                    <option value='{{i}}' selected>{{i}}위</option>
                    {% else %}
                    <option value='{{i}}'>{{i}}위</option>
                    {% endif %}
                {% endfor %}
            </select> &nbsp;
            
            <br/>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;종료범위

            <select class ='form-control' name='year2'>
                {% if request.GET.year2 == '2020' %}
                <option value='2020'selected>2020</option>
                {% else %}
                <option value='2020'>2020</option>
                {% endif %}
                {% if request.GET.year2 == '2019' %}
                <option value='2019'selected>2019</option>
                {% else %}
                <option value='2019'>2019</option>
                {% endif %}
            </select> &nbsp;

            <select class ='form-control' name='month2'>
                {% for i in MM %}
                    {% if i == request.GET.month2 %}
                    <option value='{{i}}' selected>{{i}}월</option>
                    {% else %}
                    <option value='{{i}}'>{{i}}월</option>
                    {% endif %}
                {% endfor %}
            </select> &nbsp;
            
            <select class ='form-control' name='day2'>
                {% for i in DD %}
                    {% if i|stringformat:"i" == request.GET.day2 %}
                    <option value='{{i}}' selected>{{i}}일</option>
                    {% else %}
                    <option value='{{i}}'>{{i}}일</option>
                    {% endif %}
                {% endfor %}
            </select> &nbsp;
            
            <select class ='form-control' name='time2'>
                {% for i in SS %}
                    {% if i|stringformat:"i" == request.GET.time2 %}
                    <option value='{{i}}' selected>{{i}}시</option>
                    {% else %}
                    <option value='{{i}}'>{{i}}시</option>
                    {% endif %}
                {% endfor %}
            </select> &nbsp;
            
            <select class ='form-control' name='rank2'>
                {% for i in RK %}
                    {% if i|stringformat:"i" == request.GET.rank2 %}
                    <option value='{{i}}' selected>{{i}}위</option>
                    {% else %}
                    <option value='{{i}}'>{{i}}위</option>
                    {% endif %}
                {% endfor %}
            </select> &nbsp;
            
            <input type ='submit'class='btn btn-secondary' value='필터' />
        </form>
    </div>

    <table border='4' class = 'table'>
        <tr>
            <th>검색어</th>
            <th>검색횟수</th>
        </tr>
        
        {% for one in filtered %}
        <tr>
            <td><a href="#">{{one.0}}</a></td>
            <td>{{one.1}}</td>
        </tr>  
        {% endfor %}  
    </table>
    </form>
</div>

<script src="/js/ace/ace.js" type="text/javascript"></script>
<script src="/js/ace/mode-javascript.js" type="text/javascript"></script>
<script src="/js/ace/theme-tomorrow.js" type="text/javascript"></script>
<script>
    // var objx = eval(str1)  //문자열로 [1,2,3,4]  => javascript배열로변경
    //objx.unshift('x');     //['x',1,2,3,4]
    //console.log(objx)

    //var objy = eval(str2)
    //objy.unshift('rank');
    //console.log(objy)

    //str_xs = {'rank': 'x' }
    //print(str_xs)
    $(function(){

        var str1_1='{{word1}}'
        str1_1=str1_1.replace(/&#x27;/gi, "'").replace(/&#39;/gi, "'");
        var objx1 = eval(str1_1)
                
        var str2_1='{{rank1}}'
        var objy1 = eval(str2_1)


        var str1_2='{{word2}}'
        str1_2=str1_2.replace(/&#x27;/gi, "'").replace(/&#39;/gi, "'");
        var objx2 = eval(str1_2)
        
        var str2_2='{{rank2}}'
        var objy2 = eval(str2_2)

        var str1_3='{{word3}}'
        str1_3=str1_3.replace(/&#x27;/gi, "'").replace(/&#39;/gi, "'");
        var objx3 = eval(str1_3)
        
        var str2_3='{{rank3}}'
        var objy3 = eval(str2_3)

        var str1_4='{{word4}}'
        str1_4=str1_4.replace(/&#x27;/gi, "'").replace(/&#39;/gi, "'");
        var objx4 = eval(str1_4)       
        
        var str2_4='{{rank4}}'
        var objy4 = eval(str2_4)

        var str1_5='{{word5}}'
        str1_5=str1_5.replace(/&#x27;/gi, "'").replace(/&#39;/gi, "'");
        var objx5 = eval(str1_5)
        
        
        var str2_5='{{rank5}}'
        var objy5 = eval(str2_5)
        var chart = c3.generate({
            bindto:"#chart",
            data: {
                columns:[
                    [objx1,objy1],
                    [objx2,objy2],
                    [objx3,objy3],
                    [objx4,objy4],
                    [objx5,objy5]
                ],
                type : 'donut',
                onclick: function (d, i) { console.log("onclick", d, i); },
                onmouseover: function (d, i) { console.log("onmouseover", d, i); },
                onmouseout: function (d, i) { console.log("onmouseout", d, i); }
            },
            donut: {
                title: "기간별 검색어 top5"
            }
        });
    })

</script>
<script src="/js/samples/chart_donut-fca576b3.js" type="text/javascript"></script>


</body>
</html>